/*******************************************************************************
 * Copyright (c) 2018 VRE4EIC Consortium
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *******************************************************************************/

package forth.ics.isl.data.model.suggest;

import forth.ics.isl.data.model.parser.FilterExp;
import forth.ics.isl.data.model.parser.QueryDataModel;
import forth.ics.isl.data.model.parser.RelatedModel;
import forth.ics.isl.data.model.parser.Utils;
import forth.ics.isl.service.DBService;
import forth.ics.isl.triplestore.RestClient;
import forth.ics.isl.triplestore.VirtuosoRestClient;
import java.io.IOException;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;

/**
 *
 * @author rousakis
 */
public class EntitiesSuggester {

    private QueryDataModel model;
    private String fromClause, logicalExpression;
    private RelatedModel rowModel;
    private String namespace, endpoint, token;

    public EntitiesSuggester(JSONObject jsonModel, String namespace, String endpoint, String token) {
        init(jsonModel);
        this.namespace = namespace;
        this.endpoint = endpoint;
        this.token = token;
    }

    public EntitiesSuggester(String rowModel, String queryModel, String namespace, String endpoint, String token) {
        this.model = new QueryDataModel(queryModel);
        this.rowModel = new RelatedModel(rowModel);
        this.fromClause = model.getSelectedGraphsClause();
        this.namespace = namespace;
        this.endpoint = endpoint;
        this.token = token;
    }

    public EntitiesSuggester(String jsonModelString, String namespace, String endpoint, String token) {
        JSONObject jsonModel = Utils.parse(jsonModelString);
        this.model = new QueryDataModel(jsonModelString);
        this.fromClause = (String) jsonModel.get("queryFrom");
        this.logicalExpression = (String) jsonModel.get("logicalExpression");
        JSONObject row = (JSONObject) jsonModel.get("rowModel");
        if (row != null) {
            this.rowModel = new RelatedModel(row, model.getSelectedGraphs());
        } else {
            this.rowModel = null;
        }
        this.namespace = namespace;
        this.endpoint = endpoint;
        this.token = token;
    }

    private void init(JSONObject jsonModel) {
        this.model = new QueryDataModel(jsonModel);
        this.fromClause = (String) jsonModel.get("queryFrom");
        this.rowModel = new RelatedModel((String) jsonModel.get("rowModel"));
    }

    public String getFromClause() {
        return fromClause;
    }

    public RelatedModel getRowModel() {
        return rowModel;
    }

    public QueryDataModel getModel() {
        return model;
    }

    public JSONArray retrieveRelationsEntities(ArrayList<Map> entities) throws IOException, ParseException, SQLException {
        Map<String, String> relations = DBService.retrieveAllRelations();
        HashMap<String, JSONObject> entitiesMap = new HashMap<>();
        for (int i = 0; i < entities.size(); i++) {
            JSONObject entity = new JSONObject(entities.get(i));
            entitiesMap.put((String) entity.get("uri"), entity);
        }
        JSONArray result = new JSONArray();
        JSONArray queries = new JSONArray();
        //find the related model selected
        List<RelatedModel> relModels = getModel().getRelatedModels();
        RelatedModel row = getRowModel();
        RelatedModel testingRelModel = findNullRelatedModel(relModels, null);
        testingRelModel.setSelectedGraphs(this.model.getSelectedGraphs());
        HashMap<String, List<String>> sugRelationRelEntities;
        if (row != null) {
            sugRelationRelEntities = row.getSugRelationsRelatedEntities();
        } else {
            sugRelationRelEntities = testingRelModel.findRelationsRelatedEntities(model.getTargetModel().getName());
        }
        if (testingRelModel.getFilterExp() == FilterExp.OR) {
            for (String relation : sugRelationRelEntities.keySet()) {
                for (String relatedEntityUri : sugRelationRelEntities.get(relation)) {
                    JSONObject obj = new JSONObject();
                    JSONObject relEntity = entitiesMap.get(relatedEntityUri);
                    if (relEntity == null) {
                        continue;
                    }
                    obj.put("related_entity", relEntity);
                    JSONObject relJSON = new JSONObject();
                    relJSON.put("uri", relation);
                    relJSON.put("name", relations.get(relation));
                    obj.put("relation", relJSON);
                    result.add(obj);
                }
            }
        } else {
            for (String relation : sugRelationRelEntities.keySet()) {
//                String relEntityUri = sugRelationRelEntities.get(relation);
                for (String relEntityUri : sugRelationRelEntities.get(relation)) {
                    JSONObject relEntity = entitiesMap.get(relEntityUri);
                    if (relEntity == null) {
                        continue;
                    }
                    testingRelModel.setRelatedVarName((String) relEntity.get("var_name"));
                    testingRelModel.setRelatedUri(relEntityUri);
                    testingRelModel.setRelationUri(relation);
                    testingRelModel.setRelationName(relations.get(relation));
                    String query = model.toSPARQL();
                    if (query != null) {
                        query = query.replace("distinct", "") + " limit 1";
                        queries.add(query);
                        System.out.println(query);
                    }
                }
            }
            if (!queries.isEmpty()) {
                // execute the set of queries
//                RestClient client = new RestClient(endpoint, namespace, token);
                VirtuosoRestClient client = new VirtuosoRestClient(endpoint, token);
                JSONArray results = (JSONArray) new JSONParser().parse(client.executeBatchSparqlQueryPOST(queries, "application/json").readEntity(String.class));
//                System.out.println(results.toString());
                int i = 0;
                for (String relation : sugRelationRelEntities.keySet()) {
                    for (String relEntityUri : sugRelationRelEntities.get(relation)) {
                        JSONObject relEntity = entitiesMap.get(relEntityUri);
                        if (relEntity == null) {
                            continue;
                        }
                        JSONObject qRes = (JSONObject) new JSONParser().parse((String) results.get(i));
                        JSONArray res = (JSONArray) ((JSONObject) qRes.get("results")).get("bindings");
                        if (!res.isEmpty()) {
//                            String relatedEntityUri = sugRelationRelEntities.get(relation);
                            JSONObject obj = new JSONObject();
                            JSONObject relatedEntity = entitiesMap.get(relEntityUri);
                            obj.put("related_entity", relatedEntity);
                            JSONObject relJSON = new JSONObject();
                            relJSON.put("uri", relation);
                            relJSON.put("name", relations.get(relation));
                            obj.put("relation", relJSON);
                            result.add(obj);
                            System.out.println(relation + " -> " + sugRelationRelEntities.get(relation));
                        }
                        i++;
                    }
                }
            }
        }
        return result;
    }

    private RelatedModel findRelatedModelFromRow(List<RelatedModel> relModels, RelatedModel searched, RelatedModel found) {
        for (RelatedModel relModel : relModels) {
            if (found != null) {
                break;
            }
            if (relModel.equals(searched)) {
                return findRelatedModelFromRow(relModel.getRelatedModels(), searched, relModel);
            }
            if (!relModel.getRelatedModels().isEmpty()) {
                return findRelatedModelFromRow(relModel.getRelatedModels(), searched, found);
            }
        }
        return found;
    }

    private RelatedModel findNullRelatedModel(List<RelatedModel> relModels, RelatedModel found) {
        if (relModels != null) {
            for (RelatedModel relModel : relModels) {
                if (found != null) {
                    break;
                }
                if (relModel.isNullRelatedModel()) {
                    return findNullRelatedModel(relModel.getRelatedModels(), relModel);
                }
                if (relModel.getRelatedModels() != null && !relModel.getRelatedModels().isEmpty()) {
                    RelatedModel result = findNullRelatedModel(relModel.getRelatedModels(), found);
                    if (result != null) {
                        return result;
                    }
                }
            }
        }
        return found;
    }

    public static void main(String[] args) throws IOException, ParseException, SQLException {
        //QueryModel: Person -> OrgUnit, maria searched in OrgUnit
        //RowModel:OrgUnit
        String suggestModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"rowModel\":{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":10,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@  <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ rdfs:label ?persName. \\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?persName as ?name) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":10,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
        //QueryModel: Person -> OrgUnit, maria searched in OrgUnit -> Project
        //RowModel:Project
//        suggestModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"rowModel\":{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is participant in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/is%20participant%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_title> ?projectTitle.\\nOPTIONAL {?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_URI> ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?@#$%VAR%$#@).\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?projectAcronym.\\n?@#$%VAR%$#@ rdfs:label ?projName.\\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":8,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) (?projName as ?name) (?projectAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@  <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ rdfs:label ?persName. \\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?persName as ?name) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is participant in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/is%20participant%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_title> ?projectTitle.\\nOPTIONAL {?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_URI> ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?@#$%VAR%$#@).\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?projectAcronym.\\n?@#$%VAR%$#@ rdfs:label ?projName.\\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":8,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) (?projName as ?name) (?projectAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";

        //QueryModel: Person -> OrgUnit, maria searched in OrgUnit -> (Project or )
        //RowModel:OrgUnit
        suggestModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"rowModel\":{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is participant in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/is%20participant%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_title> ?projectTitle.\\nOPTIONAL {?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_URI> ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?@#$%VAR%$#@).\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?projectAcronym.\\n?@#$%VAR%$#@ rdfs:label ?projName.\\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":8,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) (?projName as ?name) (?projectAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},{\"id\":5,\"level\":1,\"outerSelectedFilterExpression\":\"OR\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},\"logicalExpression\":\"OR\",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@  <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ rdfs:label ?persName. \\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?persName as ?name) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is participant in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/is%20participant%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_title> ?projectTitle.\\nOPTIONAL {?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_URI> ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?@#$%VAR%$#@).\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?projectAcronym.\\n?@#$%VAR%$#@ rdfs:label ?projName.\\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":8,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) (?projName as ?name) (?projectAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},{\"id\":5,\"level\":1,\"outerSelectedFilterExpression\":\"OR\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
        //QueryModel: Person -> (OrgUnit and ...)
//        suggestModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"logicalExpression\":\"AND\",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@  <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ rdfs:label ?persName. \\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?persName as ?name) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},{\"id\":1,\"level\":0,\"outerSelectedFilterExpression\":\"AND\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
//        QueryModel: Person -> (OrgUnit or ...)
//        suggestModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"logicalExpression\":\"OR\",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@  <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ rdfs:label ?persName. \\n\",\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers \\n\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?persName as ?name) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"selection_pattern\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES <http://eurocris.org/ontology/cerif#has_classification> <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser <http://eurocris.org/ontology/cerif#has_acronym> ?Service.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_acronym> ?orgAcronym.\",\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score) \\n\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?@#$%VAR%$#@ as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"},{\"id\":3,\"level\":0,\"outerSelectedFilterExpression\":\"OR\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":true,\"allRelatedEntitiesSelectedList\":[{\"name\":\"Search By Keyword\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"disabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";

        String token = "4c007c2e-0443-4368-9486-d08ba4fc1c10";
        String endpoint = "http://139.91.183.48:8181/EVREMetadataServices";
        endpoint = "http://139.91.183.97:8080/EVREMetadataServices-1.0-SNAPSHOT";
        String namespace = "vre4eic";
        /////////////////////////////////
//        EntitiesSuggester suggester = new EntitiesSuggester(rowModel, queryModel, namespace, endpoint, token);
        EntitiesSuggester suggester = new EntitiesSuggester(suggestModel, namespace, endpoint, token);

        ArrayList<Map> entities = new ArrayList();
        JSONArray entitiesJSON = DBService.retrieveAllEntities(false);
        for (int i = 0; i < entitiesJSON.size(); i++) {
            JSONObject obj = (JSONObject) entitiesJSON.get(i);
            Map map = (Map) obj;
            entities.add(map);
        }
        JSONArray result = suggester.retrieveRelationsEntities(entities);
        System.out.println(result.toJSONString());
        ////////////////
        JSONArray relations = new JSONArray();
        String targetEntity = "OrganisationUnit";
        String relatedEntity = "Person";
        for (int i = 0; i < result.size(); i++) {
            JSONObject obj = (JSONObject) result.get(i);
            String relEntity = (String) ((JSONObject) (obj.get("related_entity"))).get("name");
            if (relEntity.equals(relatedEntity)) {
                JSONObject relation = new JSONObject();
                relation.put("uri", (String) ((JSONObject) (obj.get("relation"))).get("uri"));
                relation.put("name", (String) ((JSONObject) (obj.get("relation"))).get("name"));
                relations.add(relation);
            }
        }
        System.out.println(relations.toJSONString());
    }

}
